{
	"name": "01_CREATE_TABLE_VIEW",
	"properties": {
		"content": {
			"query": "USE datascience2025;\nGO;\n\n---creando master.synPacientes\n------------------------------\n\n---Query de previsualización de parquet\nselect * \nfrom OPENROWSET (\n    BULK '/master/lideres.parquet',\n    DATA_SOURCE='UPExternalDataSource',\n    FORMAT ='PARQUET') AS [file]\nGO\ndrop EXTERNAL TABLE master.synLideres\n--- Creando external Table \nCREATE EXTERNAL TABLE master.synLideres(\nid nvarchar(20),\ncodigo_lider nvarchar(20),\nzona nvarchar(20),\n[state] nvarchar(20),\ndni nvarchar(20)\n) WITH (\n    LOCATION    ='/master/lideres.parquet',\n    DATA_SOURCE = UPExternalDataSource,\n    FILE_FORMAT = UPParquetFileFormat \n);\ngo\n\n--verificación\nSelect * from master.synLideres\n\n\n---creando master.synAtenciones\n------------------------------\n\n---Query de previsualización de parquet\nselect * \nfrom OPENROWSET (\n    BULK '/master/atenciones.parquet',\n    DATA_SOURCE='UPExternalDataSource',\n    FORMAT ='PARQUET') AS [file2]\nGO\n\n--- Creando external Table \nCREATE EXTERNAL TABLE master.synAtenciones(\ncontact_id nvarchar(20),\netapa_de_ejecucion NVARCHAR(100)\n) WITH (\n    LOCATION    ='/master/atenciones.parquet',\n    DATA_SOURCE = UPExternalDataSource,\n    FILE_FORMAT = UPParquetFileFormat \n);\ngo\n\n--verificación\nSelect * from master.synAtenciones\n\n---creando master.synEncuestas\n------------------------------\n\n---Query de previsualización de parquet\nselect * \nfrom OPENROWSET (\n    BULK '/master/encuesta.parquet',\n    DATA_SOURCE='UPExternalDataSource',\n    FORMAT ='PARQUET') AS [file]\nGO\n\n--- Creando external Table \nCREATE EXTERNAL TABLE master.synEncuestas(\n[column_3] nvarchar(400),\n[column_7] nvarchar(400),\n[column_10] nvarchar(400)\n) WITH (\n    LOCATION    ='/master/encuesta.parquet',\n    DATA_SOURCE = UPExternalDataSource,\n    FILE_FORMAT = UPParquetFileFormat \n);\ngo\n\n--verificación\nSelect * from master.synEncuestas\n\n---creando master.synClinicas\n------------------------------\n\n---Query de previsualización de parquet\nselect * \nfrom OPENROWSET (\n    BULK '/master/atenciones.parquet',\n    DATA_SOURCE='UPExternalDataSource',\n    FORMAT ='PARQUET') AS [file]\nGO\n\n--- Creando external Table \nCREATE EXTERNAL TABLE raw.synClinicas(\n[company_id] nvarchar(400),\n[contact_id] nvarchar(400)\n) WITH (\n    LOCATION    ='/master/atenciones.parquet',\n    DATA_SOURCE = UPExternalDataSource,\n    FILE_FORMAT = UPParquetFileFormat \n);\ngo\n\n--verificación\nSelect A.*,B.* from raw.synClinicas A\nleft join master.synLideres B\non A.[contact_id] = B.id \nleft join\n\nSelect * from master.synEncuestas\n\n\nCREATE EXTERNAL TABLE master.synClinicas\n WITH (\n     LOCATION = '/master/synClinicas/',\n     DATA_SOURCE = UPExternalDataSource,  \n     FILE_FORMAT = UPParquetFileFormat\n )  \n AS\nSELECT [company_id] , count (*) Cantidad_lideres\nfrom raw.synClinicas \ngroup by [company_id] \n\n--verificación\nSelect * from master.synClinicas\n\n\nSelect * from raw.synClinicas\nleft \n\n\n-----------De aquí para abajo va el código de ejemplo del profesor---------------------\n---------------------------------------------------------------------------------------\n\n--Table Type: Catalogo\nCREATE VIEW business.ProductCategory \nAS\n SELECT \n CAST (ProductCategoryID AS INT) as ProductCategoryID, CAST(Name AS VARCHAR(20)) AS ProductCategoryName from\n OPENROWSET (\n BULK 'https://sa2024uptrabajofinal.dfs.core.windows.net/master/*.parquet',\n FORMAT ='PARQUET'\n ) as [r];\nGO\n\n--Table Type: Maestro\nCREATE VIEW business.Product\n AS\n SELECT \n CAST (ProductID AS INT) as ProductID,\n CAST (ProductSubcategoryID AS INT) as ProductSubcategoryID,\n CAST (Name AS VARCHAR(50)) as Name,\n CAST (ProductNumber AS VARCHAR(25)) as ProductNumber,\n CAST (MakeFlag AS CHAR(1)) as MakeFlag,\n CAST (FinishedGoodsFlag AS VARCHAR(5)) as FinishedGoodsFlag,\n CAST (Color AS VARCHAR(15)) as Color,\n CAST (SafetyStockLevel AS SMALLINT) as SafetyStockLevel,\n CAST (ReorderPoint AS SMALLINT) as ReorderPoint,\n CAST (StandardCost AS MONEY) as StandardCost,\n CAST (ListPrice AS MONEY) as ListPrice,\n CAST (Size AS VARCHAR(5)) as Size,\n CAST (DaysToManufacture AS INT) as DaysToManufacture,\n CAST (ProductLine AS CHAR(2)) as ProductLine,\n CAST (Class AS CHAR(2)) as Class,\n CAST (Style AS CHAR(2)) as Style,\n CAST (SellStartDate AS DATETIME) as SellStartDate,\n CAST (SellEndDate AS DATETIME) as SellEndDate,\n CAST (DiscontinuedDate AS DATETIME) as DiscontinuedDate,\n CAST(r.filepath(1) AS VARCHAR(4)) as Year, \n CAST(r.filepath(2) AS VARCHAR(2)) as Month\n FROM\n OPENROWSET (\n BULK 'https://stacdatascience2025labpayano.dfs.core.windows.net/raw/advw/data/product/Year=*/Month=*/*.parquet',\n FORMAT ='PARQUET'\n ) as [r];\n GO",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "datascience2025",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}